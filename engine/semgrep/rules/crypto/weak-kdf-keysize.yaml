rules:
  - id: raptor.crypto.pbkdf2.small-key.java
    message: PBKDF2 derived key size too small. Use >= 128 bits. Verify with test vectors.
    languages: [java, kotlin]
    severity: MEDIUM
    patterns:
      - pattern: new PBEKeySpec($PW, $SALT, $ITERS, $KEYLEN)
      - metavariable-comparison:
          metavariable: $KEYLEN
          comparison: $KEYLEN < 128
    metadata:
      cwe: ["CWE-326"]
      asvs: ["V3.11"]

  - id: raptor.crypto.pbkdf2.small-key.python
    message: PBKDF2 derived key length too small. Use >= 16 bytes. Verify with test vectors.
    languages: [python]
    severity: MEDIUM
    patterns:
      - pattern: hashlib.pbkdf2_hmac($ALG, $PW, $SALT, $ITERS, $DKLEN)
      - metavariable-comparison:
          metavariable: $DKLEN
          comparison: $DKLEN < 16
    metadata:
      cwe: ["CWE-326"]
      asvs: ["V3.11"]
